
																			<!-- initial-->
<?php
$numberOfRow=10;//一個分頁的row數
if(!isset($_GET['page']) OR empty($_GET['page'])){
	$page=1;
}
else{
	$page=$_GET['page'];
}
if(!isset($_GET['categoriesID']) OR empty($_GET['categoriesID'])){
	$_GET['categoriesID']=88888;
}
$categoriesID=$_GET['categoriesID'];
if($categoriesID!=88888){
	$sql="SELECT
	posts.topic,posts.date,posts.postID,members.nickname,members.username,categories_name
	FROM
	posts
	LEFT JOIN members
	ON posts.memberID=members.memberID
	LEFT JOIN categories
	ON posts.categoriesID=categories.categoriesID
	WHERE posts.categoriesID=".$categoriesID."
	ORDER BY posts.date DESC
	LIMIT ".$numberOfRow." OFFSET ".($page-1)*$numberOfRow;
}
else{
	$sql="SELECT
	posts.topic,posts.date,posts.postID,members.nickname,members.username,categories_name
	FROM
	posts
	LEFT JOIN members
	ON posts.memberID=members.memberID
	LEFT JOIN categories
	ON posts.categoriesID=categories.categoriesID
	ORDER BY posts.date DESC
	LIMIT ".$numberOfRow." OFFSET ".($page-1)*$numberOfRow;
}

$postArray=Database::get()->execute($sql);
print_r($postArray);
if(isset($postArray) AND !empty($postArray)){
  $totalPageNum=round(count($postArray)/$numberOfRow);
}


if($page < 5){
	$count=0;
}
else{
	$count=$page-3;
}
?>




<div class='container pt-3'>
  <div class='row'>
    <div class='col-1 offset-3' style='display:inlie-block;'>
      <a style='float:eft;display:inlie-block;' class="btn btn-primary" href="?page=1">回首頁</a>
    </div>
    <div class='col-4 offset-0'>
      <ul class="pagination pagination-sm justify-content-center" >
        <!-- 分頁-->
																<!--php-->



<?php 

for($index=0;$index<7;$index=$index+1){
  $count=$count+1;
  if($count <= $totalPageNum){
    if($count==$page){
      printf('<li class="page-item"><a class="bg-dark page-link" href="?page=%d">%d</a></li>'
      ,($count),($count));
    }
	}
  else{
		printf('<li class="page-item"><a class="page-link" href="?page=%d">%d</a></li>'
		,($count),($count));
	}

$count=$count-7

?>
      </ul>
    </div>
  </div>




                                            <!--類別選擇按鍵-->
  <div class='container '>
    <ul class='nav nav-tabs nav-justified'> 
      <li class=nav-item'><a class='nav-link text-light bg-primary' href='?categoriesID=88888'>全部</a></li>
                                                  <!--php-->
      <?php
      ///這個似乎只能執行一次, 我猜拭去取得categoreisnamearray食材會執行query
      $sql="SELECT categories_name,categoriesID FROM categories";
      $postArray=Database::get()->execute($sql);
      if (isset($postArray) AND count($postArray) > 0){
        foreach($postArray as $row){
          if($_GET['categoriesID']==$row['categoriesID']){
          printf("<li class='nav-item'><a  class='active nav-link' href='?categoriesID=%s'>%s</a></li>",$row['categoriesID'],$row['categories_name']);
          }
          else{
            printf("<li class='nav-item'><a  class='nav-link' href='?categoriesID=%s'>%s</a></li>",$row['categoriesID'],$row['categories_name']);
          }
        }

      }
        $categoriesID=$_GET['categoriesID'];
      ?>
    </ul>
  </div>




  <!--文章列表-->
  <div class='container pt-2'>
    <table class="table table-hover table-dark table-striped">
      <thead>
        <tr class='d-flex '>
          <th class='col-1'>類別</th>
          <th class='col-8'>題目</th>
          <th class='col-2'>暱稱/ID</th>
          <th class='col-1'>發表時間</th>
        </tr>
      </thead>
      <tbody>


<?php


$postArray=Database::get()->execute($sql);
print_r($postArray);

if (isset($postArray) AND count($postArray) > 0){
	foreach($postArray as $row){
		printf("<tr class='d-flex '>
		<td class='col-2 style='font-size:12px;'>%s</td>
		<td class='topic col-9 font-weight-bold' style='font-size:18px;'><a href='%s'>%s</td>
		<td class='col-3' style='font-size:14px;'>
		<div class='row'>
		<div class='col-13'>%s</div>
		<div class='col-13'>%s</div>
		</div>
		</td>
		<td class='col-2'><small>%s<small></td>
		</tr>"
		,$row['categories_name'],Config::BASE_URL."show_post?postID=".$row['postID'],$row['topic'],$row['nickname'],$row['username'],$row['date']);
	}
}

?>


      </tbody>
    </table>
  </div>

<div class='container pt-3'>
  <div class='row'>
    <div class='col-4 offset-4'>
      <ul class="pagination pagination-sm justify-content-center" >

        <!-- 分頁-->
<?php 


for($index=0;$index<7;$index=$index+1){
	$count=$count+1;
	if($count <= $totalPageNum){
		if($count==$page){
			printf('<li class="page-item"><a class="bg-dark page-link" href="?page=%d">%d</a></li>'
			,($count),($count));
		}
		else{
			printf('<li class="page-item"><a class="page-link" href="?page=%d">%d</a></li>'
			,($count),($count));
		}
	}
}

?>
      </ul>
    </div>
  </div>
